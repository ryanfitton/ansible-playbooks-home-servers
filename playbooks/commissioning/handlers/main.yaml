---
# Handler to handle common notifications. Handlers are called by other plays.
# See http://docs.ansible.com/playbooks_intro.html for more information about handlers.

- name: restart ssh
  become: true
  ansible.builtin.systemd:
    name: sshd
    state: restarted
  listen: restart ssh
  when: ansible_distribution == 'Ubuntu'  # Only for Ubuntu systems

# Restart SSH with 'su' command, only for when users is not a 'root' user
- name: restart ssh su
  become: true
  become_method: su
  ansible.builtin.systemd:
    name: sshd
    state: restarted
  listen: restart ssh
  when: ansible_user != '{{ management_user }}' and ansible_distribution == 'Debian' or ansible_distribution == 'Debian-Buster'   # Only for Debian systems

- name: reload ssh
  become: true
  ansible.builtin.systemd:
    name: sshd
    state: reloaded

- name: restart ntp
  become: true
  ansible.builtin.service:
    name: ntpd
    state: restarted

- name: 'Restart apt-daily timer'
  ansible.builtin.systemd:
    daemon_reload: true
    name: 'apt-daily.timer'
    state: 'restarted'
    enabled: true

- name: 'Restart apt-daily-upgrade timer'
  ansible.builtin.systemd:
    daemon_reload: true
    name: 'apt-daily-upgrade.timer'
    state: 'restarted'
    enabled: true